# Diff: [Part E] Project scaffolding + default docs

- **Commit:** c19498e
- **Timestamp:** 2026-02-05T20:32:55 CST
- **Stats:**
```
 .../Services/ProjectCreationService.swift          | 179 ++++++++++++++++++---
 .../ViewModels/TabManagerViewModel.swift           |   5 +-
 .../Views/Projects/NewProjectSheet.swift           |  45 +++++-
 projectStats/projectStatsTests/ServiceTests.swift  |  40 +++++
 4 files changed, 242 insertions(+), 27 deletions(-)
```

## Summary
Extended ProjectCreationService with default /docs/ folder (11 templates), Xcode project adoption flow, Next.js terminal command generation. ARCHITECTURE.md includes pre-structured Agent Teams Context section.

## Full Diff
```diff
diff --git a/projectStats/projectStats/Services/ProjectCreationService.swift b/projectStats/projectStats/Services/ProjectCreationService.swift
index bb1b040..d12f332 100644
--- a/projectStats/projectStats/Services/ProjectCreationService.swift
+++ b/projectStats/projectStats/Services/ProjectCreationService.swift
@@ -97,6 +97,35 @@ final class ProjectCreationService {
         return projectURL
     }
 
+    /// For Xcode projects: launch Xcode and let user pick folder after
+    func launchXcodeForProjectCreation() {
+        NSWorkspace.shared.open(URL(fileURLWithPath: "/Applications/Xcode.app"))
+    }
+
+    /// For Xcode: user picks existing Xcode project folder, we add docs + DB entry
+    func adoptXcodeProject(at url: URL, context: ModelContext) throws {
+        try createDefaultDocs(at: url, projectName: url.lastPathComponent)
+        let cached = CachedProject(
+            path: url.path,
+            name: url.lastPathComponent,
+            language: "Swift",
+            lineCount: 0,
+            fileCount: 0,
+            promptCount: 0,
+            workLogCount: 0,
+            lastScanned: Date()
+        )
+        context.insert(cached)
+        try? context.save()
+    }
+
+    /// Terminal command for Next.js (to be sent to workspace terminal)
+    func nextjsCommand(projectName: String) -> String {
+        "npx create-next-app@latest \(projectName) --typescript --tailwind --eslint --app --src-dir --import-alias \"@/*\""
+    }
+
+    // MARK: - Scaffolding
+
     private func scaffoldProject(type: ProjectType, at url: URL) throws {
         switch type {
         case .blank:
@@ -106,23 +135,54 @@ final class ProjectCreationService {
         case .python:
             try createPythonScaffold(at: url)
         case .nextjs:
-            // Handled by terminal command in Scope E
-            break
+            try createGitignore(at: url, content: gitignoreGeneral)
+            // Actual scaffolding happens via terminal command
         case .xcode:
-            // Handled by Xcode launch in Scope E
+            // Handled separately via launchXcodeForProjectCreation
             break
         }
+        // All types get default docs
+        try createDefaultDocs(at: url, projectName: url.lastPathComponent)
     }
 
-    private func createPythonScaffold(at url: URL) throws {
-        let main = """
-        def main():
-            print("Hello, World!")
+    // MARK: - Default Docs
 
+    func createDefaultDocs(at projectURL: URL, projectName: String) throws {
+        let docsDir = projectURL.appendingPathComponent("docs")
+        try FileManager.default.createDirectory(at: docsDir, withIntermediateDirectories: true)
 
-        if __name__ == "__main__":
-            main()
-        """
+        let docs: [(String, String)] = [
+            ("ARCHITECTURE.md", architectureTemplate(projectName: projectName)),
+            ("FILE_STRUCTURE.md", fileStructureTemplate(projectName: projectName)),
+            ("MODELS.md", sectionTemplate(title: "Models", projectName: projectName, description: "Data models reference.")),
+            ("SERVICES.md", sectionTemplate(title: "Services", projectName: projectName, description: "Service layer reference.")),
+            ("VIEWS.md", sectionTemplate(title: "Views", projectName: projectName, description: "View hierarchy reference.")),
+            ("VIEWMODELS.md", sectionTemplate(title: "ViewModels", projectName: projectName, description: "ViewModel reference.")),
+            ("DEPENDENCIES.md", sectionTemplate(title: "Dependencies", projectName: projectName, description: "External dependencies.")),
+            ("KNOWN_ISSUES.md", sectionTemplate(title: "Known Issues", projectName: projectName, description: "Known bugs and limitations.")),
+            ("TODO.md", sectionTemplate(title: "TODO", projectName: projectName, description: "Planned work.")),
+            ("CHANGELOG.md", changelogTemplate(projectName: projectName)),
+            ("README.md", readmeTemplate(projectName: projectName)),
+        ]
+
+        for (filename, content) in docs {
+            let fileURL = docsDir.appendingPathComponent(filename)
+            if !FileManager.default.fileExists(atPath: fileURL.path) {
+                try content.write(to: fileURL, atomically: true, encoding: .utf8)
+            }
+        }
+
+        // Also create README at root if it doesn't exist
+        let rootReadme = projectURL.appendingPathComponent("README.md")
+        if !FileManager.default.fileExists(atPath: rootReadme.path) {
+            try readmeTemplate(projectName: projectName).write(to: rootReadme, atomically: true, encoding: .utf8)
+        }
+    }
+
+    // MARK: - Type-Specific Scaffolding
+
+    private func createPythonScaffold(at url: URL) throws {
+        let main = "def main():\n    print(\"Hello, World!\")\n\n\nif __name__ == \"__main__\":\n    main()\n"
         try main.write(to: url.appendingPathComponent("main.py"), atomically: true, encoding: .utf8)
         try "".write(to: url.appendingPathComponent("requirements.txt"), atomically: true, encoding: .utf8)
         try createGitignore(at: url, content: gitignorePython)
@@ -142,24 +202,97 @@ final class ProjectCreationService {
         }
     }
 
-    private var gitignoreGeneral: String {
+    // MARK: - Doc Templates
+
+    private func architectureTemplate(projectName: String) -> String {
         """
-        .DS_Store
-        .build/
-        *.swp
-        *~
+        # \(projectName) — Architecture
+
+        ## Tech Stack
+        _List primary technologies, frameworks, and tools._
+
+        ## Folder Structure
+        _Describe the directory layout and conventions._
+
+        ## Key Design Decisions
+        _Document important architectural choices and rationale._
+
+        ## Data Flow
+        _Describe how data moves through the application._
+
+        ## Agent Teams Context
+
+        > This section is auto-updated by the Update Docs button when Agent Teams is enabled.
+
+        ### File Ownership Boundaries
+        | Domain | Primary Files | Owner Pattern |
+        |--------|--------------|---------------|
+        | _Scan project to populate_ | | |
+
+        ### Dependency Graph
+        _Run Update Docs with Agent Teams enabled to generate._
+
+        ### Shared State Risks
+        _Run Update Docs with Agent Teams enabled to generate._
         """
     }
 
-    private var gitignorePython: String {
+    private func fileStructureTemplate(projectName: String) -> String {
+        """
+        # \(projectName) — File Structure
+
+        ```
+        /
+        ├── docs/           — Project documentation
+        ├── README.md       — Project overview
+        └── ...
+        ```
+
+        _Update this file as the project grows._
         """
-        .DS_Store
-        __pycache__/
-        *.pyc
-        venv/
-        .env
-        dist/
-        *.egg-info/
+    }
+
+    private func sectionTemplate(title: String, projectName: String, description: String) -> String {
+        """
+        # \(projectName) — \(title)
+
+        \(description)
+
+        _This file is a placeholder. Fill in as the project develops._
+        """
+    }
+
+    private func changelogTemplate(projectName: String) -> String {
         """
+        # \(projectName) — Changelog
+
+        ## [Unreleased]
+        - Initial project setup
+        """
+    }
+
+    private func readmeTemplate(projectName: String) -> String {
+        """
+        # \(projectName)
+
+        ## Overview
+        _Describe what this project does._
+
+        ## Getting Started
+        _How to set up and run the project._
+
+        ## Documentation
+        See the `/docs` folder for detailed documentation.
+        """
+    }
+
+    // MARK: - Gitignore Templates
+
+    private var gitignoreGeneral: String {
+        ".DS_Store\n.build/\n*.swp\n*~\n"
+    }
+
+    private var gitignorePython: String {
+        ".DS_Store\n__pycache__/\n*.pyc\nvenv/\n.env\ndist/\n*.egg-info/\n"
     }
 }
diff --git a/projectStats/projectStats/ViewModels/TabManagerViewModel.swift b/projectStats/projectStats/ViewModels/TabManagerViewModel.swift
index cd09d09..1ac85e8 100644
--- a/projectStats/projectStats/ViewModels/TabManagerViewModel.swift
+++ b/projectStats/projectStats/ViewModels/TabManagerViewModel.swift
@@ -219,9 +219,8 @@ class TabManagerViewModel: ObservableObject {
 
         tabs = restoredTabs
 
-        let savedIndex = UserDefaults.standard.integer(forKey: "activeTabIndex")
-        if savedIndex >= 0, savedIndex < tabs.count {
-            activeTabID = tabs[savedIndex].id
+        if let homeTab = tabs.first(where: { $0.content == .home }) {
+            activeTabID = homeTab.id
         } else {
             activeTabID = tabs[0].id
         }
diff --git a/projectStats/projectStats/Views/Projects/NewProjectSheet.swift b/projectStats/projectStats/Views/Projects/NewProjectSheet.swift
index 0c2a94f..8c7e116 100644
--- a/projectStats/projectStats/Views/Projects/NewProjectSheet.swift
+++ b/projectStats/projectStats/Views/Projects/NewProjectSheet.swift
@@ -9,6 +9,7 @@ struct NewProjectSheet: View {
     @State private var selectedType: ProjectType = .blank
     @State private var errorMessage: String?
     @State private var isCreating = false
+    @State private var showXcodePicker = false
 
     var body: some View {
         VStack(alignment: .leading, spacing: 20) {
@@ -65,12 +66,25 @@ struct NewProjectSheet: View {
                     .foregroundStyle(.tertiary)
             }
 
+            if selectedType == .xcode {
+                Text("Xcode projects should be created in Xcode for proper configuration.")
+                    .font(.caption)
+                    .foregroundStyle(.secondary)
+            }
+
             if let error = errorMessage {
                 Text(error)
                     .font(.caption)
                     .foregroundStyle(.red)
             }
 
+            if showXcodePicker {
+                Button("Select Xcode Project Folder") {
+                    pickXcodeFolder()
+                }
+                .buttonStyle(.bordered)
+            }
+
             Spacer()
 
             // Actions
@@ -94,6 +108,14 @@ struct NewProjectSheet: View {
     }
 
     private func createProject() {
+        // Xcode: launch Xcode, then let user pick folder
+        if selectedType == .xcode {
+            ProjectCreationService.shared.launchXcodeForProjectCreation()
+            errorMessage = "Xcode launched. Create your project there, then use the folder picker below."
+            showXcodePicker = true
+            return
+        }
+
         isCreating = true
         errorMessage = nil
 
@@ -107,7 +129,6 @@ struct NewProjectSheet: View {
                     context: context
                 )
                 dismiss()
-                // Reload projects then open new project
                 await DashboardViewModel.shared.loadDataIfNeeded()
                 tabManager.openProject(path: url.path)
             } catch {
@@ -116,4 +137,26 @@ struct NewProjectSheet: View {
             isCreating = false
         }
     }
+
+    private func pickXcodeFolder() {
+        let panel = NSOpenPanel()
+        panel.canChooseFiles = false
+        panel.canChooseDirectories = true
+        panel.allowsMultipleSelection = false
+        panel.message = "Select your Xcode project folder"
+
+        if panel.runModal() == .OK, let url = panel.url {
+            Task { @MainActor in
+                do {
+                    let context = AppModelContainer.shared.mainContext
+                    try ProjectCreationService.shared.adoptXcodeProject(at: url, context: context)
+                    dismiss()
+                    await DashboardViewModel.shared.loadDataIfNeeded()
+                    tabManager.openProject(path: url.path)
+                } catch {
+                    errorMessage = error.localizedDescription
+                }
+            }
+        }
+    }
 }
diff --git a/projectStats/projectStatsTests/ServiceTests.swift b/projectStats/projectStatsTests/ServiceTests.swift
index fc7646d..95343a0 100644
--- a/projectStats/projectStatsTests/ServiceTests.swift
+++ b/projectStats/projectStatsTests/ServiceTests.swift
@@ -333,4 +333,44 @@ final class ServiceTests: XCTestCase {
             XCTAssertFalse(type.id.isEmpty)
         }
     }
+
+    func testCreateDefaultDocsCreatesFiles() throws {
+        let tmp = FileManager.default.temporaryDirectory.appendingPathComponent(UUID().uuidString)
+        try FileManager.default.createDirectory(at: tmp, withIntermediateDirectories: true)
+        defer { try? FileManager.default.removeItem(at: tmp) }
+
+        try ProjectCreationService.shared.createDefaultDocs(at: tmp, projectName: "TestProject")
+
+        let docsDir = tmp.appendingPathComponent("docs")
+        XCTAssertTrue(FileManager.default.fileExists(atPath: docsDir.path))
+        XCTAssertTrue(FileManager.default.fileExists(atPath: docsDir.appendingPathComponent("ARCHITECTURE.md").path))
+        XCTAssertTrue(FileManager.default.fileExists(atPath: docsDir.appendingPathComponent("FILE_STRUCTURE.md").path))
+        XCTAssertTrue(FileManager.default.fileExists(atPath: docsDir.appendingPathComponent("MODELS.md").path))
+        XCTAssertTrue(FileManager.default.fileExists(atPath: docsDir.appendingPathComponent("TODO.md").path))
+        XCTAssertTrue(FileManager.default.fileExists(atPath: docsDir.appendingPathComponent("CHANGELOG.md").path))
+        XCTAssertTrue(FileManager.default.fileExists(atPath: docsDir.appendingPathComponent("README.md").path))
+        // Root README also created
+        XCTAssertTrue(FileManager.default.fileExists(atPath: tmp.appendingPathComponent("README.md").path))
+    }
+
+    func testArchitectureMdHasAgentTeamsSection() throws {
+        let tmp = FileManager.default.temporaryDirectory.appendingPathComponent(UUID().uuidString)
+        try FileManager.default.createDirectory(at: tmp, withIntermediateDirectories: true)
+        defer { try? FileManager.default.removeItem(at: tmp) }
+
+        try ProjectCreationService.shared.createDefaultDocs(at: tmp, projectName: "TestProject")
+
+        let archContent = try String(contentsOf: tmp.appendingPathComponent("docs/ARCHITECTURE.md"), encoding: .utf8)
+        XCTAssertTrue(archContent.contains("Agent Teams Context"))
+        XCTAssertTrue(archContent.contains("File Ownership Boundaries"))
+        XCTAssertTrue(archContent.contains("Dependency Graph"))
+        XCTAssertTrue(archContent.contains("Shared State Risks"))
+    }
+
+    func testNextjsCommandGeneration() {
+        let cmd = ProjectCreationService.shared.nextjsCommand(projectName: "my-app")
+        XCTAssertTrue(cmd.contains("npx create-next-app@latest"))
+        XCTAssertTrue(cmd.contains("my-app"))
+        XCTAssertTrue(cmd.contains("--typescript"))
+    }
 }
```
