# Prompt 14: VIBE Tab — Fix Output Pipeline + Chat UI Redesign

## CONTEXT

The VIBE tab has two problems:
1. **Output is broken** — text appears one character per line with raw escape codes leaking through (`[?2026]`, `[?2004h]`). The wiring chain from Prompt 12 is actually complete (`VibeOutputTerminalView.dataReceived` → `tab.recordOutput` → `onOutputCallback` → `bridge.handleOutput`), but the hidden terminal has `.frame(width: 0, height: 0).hidden()` which means SwiftTerm has no terminal dimensions, causing it to buffer incorrectly. The ANSI stripping regex also misses DEC private mode sequences.
2. **The UI looks bad** — it's a raw `Text()` dumping everything into one monospaced blob. No visual distinction between user input and Claude's responses. The input area looks like an afterthought.

This prompt fixes both. The output pipeline needs to actually work, and the UI needs to be a proper chat interface.


## WHAT EXISTS (do NOT break)

- `VibeTabView.swift` — main VIBE UI, hosts hidden `VibeTerminalHostView`
- `VibeTerminalHostView.swift` — NSViewRepresentable that creates `VibeOutputTerminalView`, starts shell, hooks `onOutput`
- `VibeTerminalBridge.swift` — manages planning/execution tabs, has `handleOutput()` and `handleExecutionOutput()`, `onOutputCallback` is set in `boot()`
- `TerminalTabItem` — has `onOutputCallback` property (line 35), called from `recordOutput()` (line 162)
- `TerminalTabItem.stripAnsiCodes()` — regex only catches `\x1B\[[0-9;]*[a-zA-Z]`, misses `[?` sequences
- All existing terminal, workspace, and IDE views — DO NOT TOUCH
- XP system, achievements, conversation service — all working, don't touch


## SCOPE A — Fix Terminal Dimensions
... (full scope A content)

## SCOPE B — Fix ANSI Stripping
... (full scope B content)

## SCOPE C — Chat Entry Model
... (full scope C content)

## SCOPE D — Chat UI Redesign
... (full scope D content)

## SCOPE E — Verify End-to-End
... (full scope E content)
