# ProjectStats - macOS Developer Dashboard
## Prompt 1: Complete Build

### Project Overview

Build a native macOS app that scans a developer's `/Code` directory, discovers all projects, displays stats, integrates with GitHub, and provides quick access via a menu bar icon. This is a personal developer dashboard for tracking coding activity across all projects.

**Location:** `/Users/calebbelshe/Code/openProjects/projectStats/`

**Structure:**
```
projectStats/
â”œâ”€â”€ projectStats/          # Xcode project + Swift source
â”œâ”€â”€ prompts/               # This file and future prompts
â”‚   â””â”€â”€ 1.md
â””â”€â”€ work/                  # Work logs
    â””â”€â”€ stats/             # Per-commit stats
```

---

## Tech Stack

- **Language:** Swift 5.9+
- **UI:** SwiftUI
- **Frameworks:** 
  - AppKit (for menu bar NSStatusItem)
  - Charts (for graphs)
  - SwiftData (for caching)
- **Minimum macOS:** 14.0 (Sonoma)
- **Architecture:** MVVM

---

## Core Features to Build

### 1. Menu Bar App

The app lives primarily in the menu bar. Clicking the icon shows a popover.

**Menu Bar Icon:**
- Use SF Symbol `chevron.left.forwardslash.chevron.right` or custom icon
- Show badge with active project count (optional)

**Popover Content:**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ðŸ“Š ProjectStats                    [âš™ï¸] â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Today: 1,247 lines â”‚ 8 commits         â”‚
â”‚ ðŸ”¥ Streak: 12 days                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â­ Recent Projects                      â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ ðŸ“ andersonFlightServicesV1        â”‚ â”‚
â”‚ â”‚    Last: 2 hours ago â”‚ 40k lines   â”‚ â”‚
â”‚ â”‚    [Open] [GitHub] [ðŸ“‹]            â”‚ â”‚
â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚ â”‚ ðŸ“ projectStats                    â”‚ â”‚
â”‚ â”‚    Last: Just now â”‚ 1.2k lines     â”‚ â”‚
â”‚ â”‚    [Open] [GitHub] [ðŸ“‹]            â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ [Open Dashboard]                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Quick Actions:**
- Click project row â†’ Opens in Finder
- `Open` button â†’ Opens in default editor (VSCode)
- `GitHub` button â†’ Opens GitHub URL in browser
- `ðŸ“‹` button â†’ Copies GitHub clone URL to clipboard
- `âš™ï¸` â†’ Opens settings

### 2. Main Dashboard Window

A full window that shows comprehensive stats.

**Sections:**

#### A. Activity Overview
- GitHub-style contribution heat map (last 365 days or last 90 days)
- Click a day to see projects worked on
- Color intensity based on lines changed or commits

#### B. Stats Cards
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    Today     â”‚ â”‚  This Week   â”‚ â”‚  This Month  â”‚ â”‚    Total     â”‚
â”‚  1,247 lines â”‚ â”‚  8,432 lines â”‚ â”‚ 32,847 lines â”‚ â”‚   152,000    â”‚
â”‚  8 commits   â”‚ â”‚  47 commits  â”‚ â”‚  189 commits â”‚ â”‚   1,247      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### C. Project List
- All discovered projects from `/Code` directory
- Sortable: Recent, Most Active, Alphabetical, By Language
- Searchable/Filterable
- Status badges: Active (7 days), In Progress (30 days), Dormant (30+ days)

#### D. Project Detail View (click to expand or navigate)
- README.md preview (parsed markdown)
- Line count, file count, language breakdown
- Commit history graph
- `/prompts` folder contents (if exists)
- `/work` folder contents (if exists)
- Quick action buttons

### 3. Project Scanner

Scans the configured code directory (default: `~/Code`) for projects.

**Detection Logic:**
```swift
func isProject(_ url: URL) -> Bool {
    let hasGit = FileManager.default.fileExists(atPath: url.appendingPathComponent(".git").path)
    let hasPackageJson = FileManager.default.fileExists(atPath: url.appendingPathComponent("package.json").path)
    let hasXcodeproj = url.pathExtension == "xcodeproj" || 
                       FileManager.default.contentsOfDirectory(at: url).contains { $0.pathExtension == "xcodeproj" }
    let hasCargo = FileManager.default.fileExists(atPath: url.appendingPathComponent("Cargo.toml").path)
    // etc.
    
    return hasGit || hasPackageJson || hasXcodeproj || hasCargo
}
```

**Data Extraction:**
- **Name:** Folder name
- **Description:** Parse first paragraph of README.md
- **GitHub URL:** Parse from `.git/config` (remote "origin" url)
- **Language:** Detect from file extensions (most common)
- **Line Count:** Count lines in source files (exclude node_modules, .git, etc.)
- **File Count:** Count source files
- **Last Modified:** Most recent file modification or last commit
- **Prompts:** Count files in `/prompts` folder if exists
- **Work Logs:** Count files in `/work` folder if exists

### 4. Git Integration (Local)

Execute git commands to get stats without needing GitHub API.

```swift
class GitService {
    func getRemoteURL(at path: URL) -> String? {
        // git config --get remote.origin.url
    }
    
    func getLastCommit(at path: URL) -> Commit? {
        // git log -1 --format="%H|%s|%an|%ai"
    }
    
    func getCommitCount(at path: URL, since: Date) -> Int {
        // git rev-list --count --since="2024-01-01" HEAD
    }
    
    func getCommitHistory(at path: URL, limit: Int) -> [Commit] {
        // git log -n 50 --format="%H|%s|%an|%ai"
    }
    
    func getLinesChanged(at path: URL, since: Date) -> (added: Int, removed: Int) {
        // git log --since="date" --numstat --format=""
        // Parse: added \t removed \t filename
    }
    
    func getDailyActivity(at path: URL, days: Int) -> [Date: ActivityStats] {
        // git log --since="X days ago" --format="%ai" --numstat
        // Aggregate by day
    }
}
```

### 5. GitHub Integration (Optional, API)

For enhanced stats, allow optional GitHub PAT.

```swift
class GitHubClient {
    var token: String?
    
    func getContributionCalendar(username: String) async throws -> ContributionData {
        // GraphQL query for contribution calendar
    }
    
    func getRepoStats(owner: String, repo: String) async throws -> RepoStats {
        // GET /repos/{owner}/{repo}
        // Stars, forks, open issues, etc.
    }
}
```

### 6. Settings

```swift
struct AppSettings {
    var codeDirectory: URL          // Default: ~/Code
    var githubToken: String?        // Optional PAT
    var defaultEditor: Editor       // VSCode, Xcode, Cursor, etc.
    var defaultTerminal: Terminal   // Terminal, iTerm, Warp
    var refreshInterval: Int        // Minutes, default 15
    var launchAtLogin: Bool
    var showInMenuBar: Bool
    var showInDock: Bool
    var theme: Theme               // System, Light, Dark
}

enum Editor: String, CaseIterable {
    case vscode = "Visual Studio Code"
    case xcode = "Xcode"
    case cursor = "Cursor"
    case sublime = "Sublime Text"
    case finder = "Finder"
}
```

### 7. Data Persistence (SwiftData)

```swift
@Model
class CachedProject {
    var path: String
    var name: String
    var descriptionText: String?
    var githubURL: String?
    var language: String?
    var lineCount: Int
    var fileCount: Int
    var promptCount: Int
    var workLogCount: Int
    var lastCommitHash: String?
    var lastCommitMessage: String?
    var lastCommitDate: Date?
    var lastScanned: Date
    
    // Computed
    var status: ProjectStatus {
        guard let lastCommit = lastCommitDate else { return .dormant }
        let daysSince = Calendar.current.dateComponents([.day], from: lastCommit, to: Date()).day ?? 0
        if daysSince <= 7 { return .active }
        if daysSince <= 30 { return .inProgress }
        return .dormant
    }
}

@Model
class DailyActivity {
    var date: Date
    var projectPath: String
    var linesAdded: Int
    var linesRemoved: Int
    var commits: Int
}
```

---

## File Structure

```
projectStats/
â”œâ”€â”€ projectStats/
â”‚   â”œâ”€â”€ projectStats.xcodeproj
â”‚   â””â”€â”€ projectStats/
â”‚       â”œâ”€â”€ App/
â”‚       â”‚   â”œâ”€â”€ ProjectStatsApp.swift       # @main, WindowGroup + MenuBarExtra
â”‚       â”‚   â””â”€â”€ AppDelegate.swift           # Optional, for advanced menu bar control
â”‚       â”‚
â”‚       â”œâ”€â”€ Views/
â”‚       â”‚   â”œâ”€â”€ MenuBar/
â”‚       â”‚   â”‚   â”œâ”€â”€ MenuBarView.swift       # Popover content
â”‚       â”‚   â”‚   â””â”€â”€ QuickProjectRow.swift   # Compact project row for menu
â”‚       â”‚   â”‚
â”‚       â”‚   â”œâ”€â”€ Dashboard/
â”‚       â”‚   â”‚   â”œâ”€â”€ DashboardView.swift     # Main dashboard container
â”‚       â”‚   â”‚   â”œâ”€â”€ ActivityHeatMap.swift   # GitHub-style calendar
â”‚       â”‚   â”‚   â”œâ”€â”€ StatsCardsView.swift    # Today/Week/Month/Total cards
â”‚       â”‚   â”‚   â””â”€â”€ ActivityChart.swift     # Line/bar chart for commits
â”‚       â”‚   â”‚
â”‚       â”‚   â”œâ”€â”€ Projects/
â”‚       â”‚   â”‚   â”œâ”€â”€ ProjectListView.swift   # List with search/filter
â”‚       â”‚   â”‚   â”œâ”€â”€ ProjectRowView.swift    # Full project row
â”‚       â”‚   â”‚   â”œâ”€â”€ ProjectDetailView.swift # Expanded detail view
â”‚       â”‚   â”‚   â””â”€â”€ ReadmePreview.swift     # Markdown renderer
â”‚       â”‚   â”‚
â”‚       â”‚   â””â”€â”€ Settings/
â”‚       â”‚       â””â”€â”€ SettingsView.swift      # All settings
â”‚       â”‚
â”‚       â”œâ”€â”€ ViewModels/
â”‚       â”‚   â”œâ”€â”€ DashboardViewModel.swift    # Dashboard state
â”‚       â”‚   â”œâ”€â”€ ProjectListViewModel.swift  # Project list state
â”‚       â”‚   â””â”€â”€ SettingsViewModel.swift     # Settings state
â”‚       â”‚
â”‚       â”œâ”€â”€ Models/
â”‚       â”‚   â”œâ”€â”€ Project.swift               # Project struct
â”‚       â”‚   â”œâ”€â”€ Commit.swift                # Commit struct
â”‚       â”‚   â”œâ”€â”€ ActivityStats.swift         # Daily activity
â”‚       â”‚   â””â”€â”€ CachedModels.swift          # SwiftData models
â”‚       â”‚
â”‚       â”œâ”€â”€ Services/
â”‚       â”‚   â”œâ”€â”€ ProjectScanner.swift        # Scans ~/Code for projects
â”‚       â”‚   â”œâ”€â”€ GitService.swift            # Local git operations
â”‚       â”‚   â”œâ”€â”€ GitHubClient.swift          # GitHub API (optional)
â”‚       â”‚   â”œâ”€â”€ LineCounter.swift           # Count lines of code
â”‚       â”‚   â””â”€â”€ FileWatcher.swift           # Watch for changes (optional)
â”‚       â”‚
â”‚       â”œâ”€â”€ Utilities/
â”‚       â”‚   â”œâ”€â”€ Shell.swift                 # Run shell commands
â”‚       â”‚   â”œâ”€â”€ ReadmeParser.swift          # Parse README.md
â”‚       â”‚   â”œâ”€â”€ URLExtensions.swift         # URL helpers
â”‚       â”‚   â””â”€â”€ DateExtensions.swift        # Date formatting
â”‚       â”‚
â”‚       â””â”€â”€ Resources/
â”‚           â”œâ”€â”€ Assets.xcassets
â”‚           â””â”€â”€ Localizable.strings
â”‚
â”œâ”€â”€ prompts/
â”‚   â””â”€â”€ 1.md                                # This file
â”‚
â””â”€â”€ work/
    â””â”€â”€ stats/
```

---

## Implementation Order

### Phase 1: Foundation (Do First)
1. Create Xcode project with SwiftUI lifecycle
2. Set up basic file structure
3. Implement `Shell.swift` for running commands
4. Implement `GitService.swift` for basic git operations
5. Implement `ProjectScanner.swift` to find projects
6. Create `Project` model

### Phase 2: Menu Bar
1. Add `MenuBarExtra` to app
2. Create `MenuBarView` with project list
3. Implement quick actions (open, copy URL)
4. Add settings gear icon

### Phase 3: Dashboard
1. Create main `DashboardView`
2. Implement `StatsCardsView`
3. Implement `ProjectListView` with sorting/filtering
4. Implement `ProjectDetailView`

### Phase 4: Activity Tracking
1. Implement daily activity calculation from git logs
2. Create `ActivityHeatMap` view
3. Add commit history charts

### Phase 5: Polish
1. Add SwiftData caching
2. Implement settings persistence
3. Add file watcher for real-time updates
4. Add GitHub API integration (optional)
5. Add keyboard shortcuts

---

## Key Code Snippets

### Shell Command Execution
```swift
struct Shell {
    @discardableResult
    static func run(_ command: String, at path: URL? = nil) -> String {
        let task = Process()
        let pipe = Pipe()
        
        task.standardOutput = pipe
        task.standardError = pipe
        task.executableURL = URL(fileURLWithPath: "/bin/zsh")
        task.arguments = ["-c", command]
        
        if let path = path {
            task.currentDirectoryURL = path
        }
        
        do {
            try task.run()
            task.waitUntilExit()
        } catch {
            return ""
        }
        
        let data = pipe.fileHandleForReading.readDataToEndOfFile()
        return String(data: data, encoding: .utf8)?.trimmingCharacters(in: .whitespacesAndNewlines) ?? ""
    }
}
```

### Menu Bar Extra Setup
```swift
@main
struct ProjectStatsApp: App {
    var body: some Scene {
        // Main window
        WindowGroup {
            DashboardView()
        }
        
        // Menu bar
        MenuBarExtra("ProjectStats", systemImage: "chevron.left.forwardslash.chevron.right") {
            MenuBarView()
        }
        .menuBarExtraStyle(.window) // Shows as popover
        
        // Settings
        Settings {
            SettingsView()
        }
    }
}
```

### Git Remote URL Parsing
```swift
func getGitHubURL(at path: URL) -> String? {
    let remoteURL = Shell.run("git config --get remote.origin.url", at: path)
    
    // Convert SSH to HTTPS
    // git@github.com:user/repo.git -> https://github.com/user/repo
    if remoteURL.hasPrefix("git@github.com:") {
        let repoPath = remoteURL
            .replacingOccurrences(of: "git@github.com:", with: "")
            .replacingOccurrences(of: ".git", with: "")
        return "https://github.com/\(repoPath)"
    }
    
    // Already HTTPS
    if remoteURL.hasPrefix("https://github.com") {
        return remoteURL.replacingOccurrences(of: ".git", with: "")
    }
    
    return nil
}
```

### Line Counter
```swift
struct LineCounter {
    static let sourceExtensions = ["swift", "ts", "tsx", "js", "jsx", "py", "rs", "go", "java", "kt", "c", "cpp", "h", "hpp", "cs", "rb", "php"]
    
    static let excludedDirs = [".git", "node_modules", ".build", "build", "dist", "Pods", "DerivedData", ".next", "vendor"]
    
    static func countLines(in directory: URL) -> (lines: Int, files: Int) {
        var totalLines = 0
        var totalFiles = 0
        
        let enumerator = FileManager.default.enumerator(
            at: directory,
            includingPropertiesForKeys: [.isRegularFileKey],
            options: [.skipsHiddenFiles]
        )
        
        while let fileURL = enumerator?.nextObject() as? URL {
            // Skip excluded directories
            if excludedDirs.contains(where: { fileURL.path.contains("/\($0)/") }) {
                continue
            }
            
            // Check extension
            guard sourceExtensions.contains(fileURL.pathExtension.lowercased()) else {
                continue
            }
            
            // Count lines
            if let contents = try? String(contentsOf: fileURL, encoding: .utf8) {
                totalLines += contents.components(separatedBy: .newlines).count
                totalFiles += 1
            }
        }
        
        return (totalLines, totalFiles)
    }
}
```

### Activity Heat Map View
```swift
struct ActivityHeatMap: View {
    let activities: [Date: Int] // Date -> commit count or lines
    let weeks: Int = 52
    
    var body: some View {
        HStack(alignment: .top, spacing: 3) {
            ForEach(0..<weeks, id: \.self) { week in
                VStack(spacing: 3) {
                    ForEach(0..<7, id: \.self) { day in
                        let date = dateFor(week: week, day: day)
                        let count = activities[date] ?? 0
                        
                        RoundedRectangle(cornerRadius: 2)
                            .fill(colorFor(count: count))
                            .frame(width: 10, height: 10)
                            .help("\(date.formatted()): \(count) contributions")
                    }
                }
            }
        }
    }
    
    func colorFor(count: Int) -> Color {
        switch count {
        case 0: return Color.gray.opacity(0.2)
        case 1...3: return Color.green.opacity(0.3)
        case 4...6: return Color.green.opacity(0.5)
        case 7...10: return Color.green.opacity(0.7)
        default: return Color.green
        }
    }
    
    func dateFor(week: Int, day: Int) -> Date {
        // Calculate date from week/day offset
        let today = Date()
        let calendar = Calendar.current
        let daysAgo = (weeks - 1 - week) * 7 + (6 - day)
        return calendar.date(byAdding: .day, value: -daysAgo, to: today) ?? today
    }
}
```

---

## Testing

Write tests for:
1. `ProjectScanner` - finds projects correctly
2. `GitService` - parses git output correctly
3. `LineCounter` - counts lines accurately
4. `ReadmeParser` - extracts description

Use XCTest.

---

## Commit Strategy

1. "Initial Xcode project setup with SwiftUI lifecycle"
2. "Add Shell utility and GitService for git operations"
3. "Implement ProjectScanner to discover projects"
4. "Add menu bar with basic project list"
5. "Implement dashboard with stats cards"
6. "Add activity heat map and charts"
7. "Implement project detail view"
8. "Add settings and persistence"
9. "Polish and final testing"

---

## Verification Checklist

- [ ] App appears in menu bar
- [ ] Clicking menu bar icon shows popover with projects
- [ ] Projects are discovered from ~/Code
- [ ] Line counts are accurate
- [ ] GitHub URLs are extracted correctly
- [ ] Quick actions work (Open, GitHub, Copy URL)
- [ ] Dashboard shows accurate stats
- [ ] Activity heat map displays correctly
- [ ] Project detail view shows README preview
- [ ] Settings persist across launches
- [ ] App doesn't appear in Dock (menu bar only)

---

## Work Log Requirements

After completing work, create:

**File:** `/work/YYYY-MM-DD_HHMM_description.md`

Include:
- What was implemented
- Any issues encountered
- Lines of code added
- Next steps

**Stats File:** `/work/stats/YYYY-MM-DD_HHMM_<commit-hash>.md`

Include:
- Files created/modified
- Line count
-- Lines added
-- lines removed
- Test status

---

## Notes

- Start with local git operations only (no GitHub API dependency)
- The app should work completely offline
- Performance matters - scanning should be fast
- Cache aggressively with SwiftData
- Menu bar popover should open instantly

---

## Response Format

1. **Plan** - Outline your approach
2. **Difficulty** - Rate 1-10
3. **Execute** - Build the app following the phases
4. **Test** - Verify all features work
5. **Report** - Summary with self-grade (A-F)

Good luck! Build something awesome. ðŸš€

##gitHub
please commit and push to 
https://github.com/Snootypants/projectStats.git
this is the first commit to this repo so do the initializing that might be needed.